# This workflow will install Python dependencies, run tests and lint with a single version of Python
# For more information see: https://help.github.com/actions/language-and-framework-guides/using-python-with-github-actions

name: ostap 

on:
  push:
    branches: [ test ]
  pull_request:
    branches: [ test ]
jobs:
  test_docker:
     runs-on: ubuntu-latest 
     steps:
       - uses: actions/checkout@v2
       - name: Install dependencies
         run: |
          ls 
       - uses: cvmfs-contrib/github-action-cvmfs@v2
       - name: Build
         run: |
          ls /cvmfs/sft.cern.ch 
          docker  create -v  /osya --name ostap-build    gitlab-registry.cern.ch/lhcb-core/lbdocker/centos7-build:latest 
          docker cp  /home/runner/work/ostap/ostap/  ostap-build:/osya
          docker run      -v /cvmfs:/cvmfs:shared -u:0  --volumes-from ostap-build  --security-opt seccomp=unconfined gitlab-registry.cern.ch/lhcb-core/lbdocker/centos7-build:latest /bin/bash -c "cd /osya/ostap  &&  source /cvmfs/sft.cern.ch/lcg/views/dev3python2/latest/x86_64-centos7-gcc9-opt/setup.sh"
